{"ast":null,"code":"import _regeneratorRuntime from\"/Users/oskaripeltonen/Desktop/Docker-ex/Docker-Exercise/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/oskaripeltonen/Desktop/Docker-ex/Docker-Exercise/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/oskaripeltonen/Desktop/Docker-ex/Docker-Exercise/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import Blog from'./components/Blog';import blogService from'./services/blogs';import loginService from'./services/login';import Notification from'./components/Notification';import BlogCreateForm from'./components/BlogCreateForm';import Togglable from'./components/Togglable';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),blogs=_useState2[0],setBlogs=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),user=_useState8[0],setUser=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),errorMessage=_useState10[0],setErrorMessage=_useState10[1];var blogFormRef=useRef();useEffect(function(){blogService.getAll().then(function(blogs){return setBlogs(blogs.sort(function(blg,blg2){return parseInt(blg2.likes)-parseInt(blg.likes);}));});},[]);useEffect(function(){var loggedUserJSON=window.localStorage.getItem('loggedBlogappUser');if(loggedUserJSON){var _user=JSON.parse(loggedUserJSON);//console.log(user)\nsetUser(_user);blogService.setToken(_user.token);}},[]);var handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var _user2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();console.log(\"loggin in\");_context.prev=2;_context.next=5;return loginService.login({username:username,password:password});case 5:_user2=_context.sent;window.localStorage.setItem('loggedBlogappUser',JSON.stringify(_user2));blogService.setToken(_user2.token);setUser(_user2);setUsername('');setPassword('');_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](2);setErrorMessage('wrong username or password');setTimeout(function(){setErrorMessage(null);},5000);case 17:case\"end\":return _context.stop();}}},_callee,null,[[2,13]]);}));return function handleLogin(_x){return _ref.apply(this,arguments);};}();var addBlog=function addBlog(blogObject){blogFormRef.current.toggleVisibility();blogService.create(blogObject).then(function(returnedBlog){setBlogs(blogs.concat(returnedBlog));setErrorMessage(\"A new blog \".concat(blogObject.title,\" by \").concat(blogObject.author,\" added\"));setTimeout(function(){setErrorMessage(null);},5000);});};var updateBlog=function updateBlog(id,blogObject){blogService.update(id,blogObject);};var removeBlog=function removeBlog(id,tok,blog){if(window.confirm(\"Remove blog \".concat(blog.title,\" by \").concat(blog.author,\"?\"))){blogService.remove(id,\"bearer \".concat(tok)).then(function(){setBlogs(blogs.filter(function(per){return per.id!==id;}));setErrorMessage(\"Blog Deleted\");setTimeout(function(){setErrorMessage(null);},5000);});}};var handleLogout=function handleLogout(){setUser(null);window.localStorage.clear();};if(user===null){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Notification,{message:errorMessage,type:0}),/*#__PURE__*/_jsx(\"h2\",{children:\"Log in to application\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLogin,children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"username\",/*#__PURE__*/_jsx(\"input\",{id:\"username\",type:\"text\",value:username,name:\"Username\",onChange:function onChange(_ref2){var target=_ref2.target;return setUsername(target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"password\",/*#__PURE__*/_jsx(\"input\",{id:\"password\",type:\"password\",value:password,name:\"Password\",onChange:function onChange(_ref3){var target=_ref3.target;return setPassword(target.value);}})]}),/*#__PURE__*/_jsx(\"button\",{id:\"login-button\",type:\"submit\",children:\"login\"})]})]});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"BLOGS\"}),/*#__PURE__*/_jsx(Notification,{message:errorMessage,type:1}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[user.name,\" logged in \",/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleLogout();},children:\"logout\"})]})}),blogs.map(function(blog){return/*#__PURE__*/_jsx(Blog,{blog:blog,updateBlog:updateBlog,user:user,removeBlog:removeBlog},blog.id);}),/*#__PURE__*/_jsx(Togglable,{buttonLabel:\"create new blog\",ref:blogFormRef,children:/*#__PURE__*/_jsx(BlogCreateForm,{createBlog:addBlog})})]});};export default App;","map":{"version":3,"sources":["/Users/oskaripeltonen/Desktop/Docker-ex/Docker-Exercise/src/App.js"],"names":["React","useState","useEffect","useRef","Blog","blogService","loginService","Notification","BlogCreateForm","Togglable","App","blogs","setBlogs","username","setUsername","password","setPassword","user","setUser","errorMessage","setErrorMessage","blogFormRef","getAll","then","sort","blg","blg2","parseInt","likes","loggedUserJSON","window","localStorage","getItem","JSON","parse","setToken","token","handleLogin","event","preventDefault","console","log","login","setItem","stringify","setTimeout","addBlog","blogObject","current","toggleVisibility","create","returnedBlog","concat","title","author","updateBlog","id","update","removeBlog","tok","blog","confirm","remove","filter","per","handleLogout","clear","target","value","name","map"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\nimport Blog from './components/Blog'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nimport Notification from './components/Notification'\nimport BlogCreateForm from './components/BlogCreateForm'\nimport Togglable from './components/Togglable'\n\nconst App = () => {\n  const [blogs, setBlogs] = useState([])\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n  const [user, setUser] = useState(null)\n  const [errorMessage, setErrorMessage] = useState(null)\n\n  const blogFormRef = useRef()\n\n  useEffect(() => {\n    blogService.getAll().then(blogs =>\n      setBlogs( blogs.sort(function (blg, blg2) {\n        return parseInt(blg2.likes) - parseInt(blg.likes)\n      }))\n    )\n  }, [])\n\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem('loggedBlogappUser')\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON)\n      //console.log(user)\n      setUser(user)\n      blogService.setToken(user.token)\n    }\n  }, [])\n\n  const handleLogin = async (event) => {\n    event.preventDefault()\n    console.log(\"loggin in\")\n    try {\n      const user = await loginService.login({\n        username, password,\n      })\n      window.localStorage.setItem(\n        'loggedBlogappUser', JSON.stringify(user)\n      )\n      blogService.setToken(user.token)\n      setUser(user)\n      setUsername('')\n      setPassword('')\n    } catch (exception) {\n      setErrorMessage('wrong username or password')\n      setTimeout(() => {\n        setErrorMessage(null)\n      }, 5000)\n    }\n  }\n\n  const addBlog = (blogObject) => {\n    blogFormRef.current.toggleVisibility()\n    blogService\n      .create(blogObject)\n        .then(returnedBlog => {\n        setBlogs(blogs.concat(returnedBlog))\n        setErrorMessage(`A new blog ${blogObject.title} by ${blogObject.author} added`)\n        setTimeout(() => {\n          setErrorMessage(null)\n        }, 5000)\n      })\n  }\n\n  const updateBlog = (id,blogObject) => {\n    blogService\n      .update(id,blogObject)\n  }\n\n  const removeBlog = (id, tok, blog) => {\n    if(window.confirm(`Remove blog ${blog.title} by ${blog.author}?`)){\n      blogService\n      .remove(id, `bearer ${tok}`)\n        .then(() => {\n        setBlogs(blogs.filter(per => per.id !== id))\n        setErrorMessage(`Blog Deleted`)\n        setTimeout(() => {\n          setErrorMessage(null)\n        }, 5000)\n      })\n    }\n  }\n\n  const handleLogout = () => {\n    setUser(null)\n    window.localStorage.clear()\n  }\n\n  if (user === null) {\n    return (\n      <div>\n        <Notification message={errorMessage} type={0} />\n        <h2>Log in to application</h2>\n        <form onSubmit={handleLogin}>\n        <div>\n          username\n            <input\n            id=\"username\"\n            type=\"text\"\n            value={username}\n            name=\"Username\"\n            onChange={({ target }) => setUsername(target.value)}\n          />\n        </div>\n        <div>\n          password\n            <input\n            id=\"password\"\n            type=\"password\"\n            value={password}\n            name=\"Password\"\n            onChange={({ target }) => setPassword(target.value)}\n          />\n        </div>\n        <button id=\"login-button\" type=\"submit\">login</button>\n        </form>\n      </div>\n    )\n  }\n\n  return (\n    <div>\n      <h3>BLOGS</h3>\n      <Notification message={errorMessage} type={1} />\n      <div>\n        <p>{user.name} logged in <button onClick={() => handleLogout()}>logout</button></p>\n      </div>\n      {blogs.map(blog =>\n        <Blog key={blog.id} blog={blog} updateBlog={updateBlog} user={user} removeBlog={removeBlog}/>\n      )}\n      <Togglable buttonLabel=\"create new blog\" ref={blogFormRef}>\n        <BlogCreateForm createBlog={addBlog}/>\n      </Togglable>\n    </div>\n\n  )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}