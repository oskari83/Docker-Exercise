(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{42:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(17),a=n.n(c),i=n(4),o=n.n(i),u=n(6),s=n(2),l=(n(8),n(0)),j=function(e){var t=e.blog,n=e.updateBlog,c=e.user,a=e.removeBlog,i={paddingTop:2,paddingLeft:2,paddingBottom:2,border:"solid",borderWidth:1,marginBottom:2,marginTop:2},o=Object(r.useState)(!1),u=Object(s.a)(o,2),j=u[0],b=u[1],d=Object(r.useState)(parseInt(t.likes)),p=Object(s.a)(d,2),O=p[0],f=p[1],h={display:c.username===t.user.username?"":"none"},g=function(){b(!j)};return j?Object(l.jsxs)("div",{style:i,className:"blog",children:[t.title," ",t.author," ",Object(l.jsx)("button",{onClick:g,children:"hide"}),Object(l.jsx)("p",{children:t.url}),Object(l.jsxs)("p",{children:[O,Object(l.jsx)("button",{id:"like-button",onClick:function(e){e.preventDefault(),n(t.id,{title:t.title,author:t.author,url:t.url,likes:O+1,user:t.user.id}),f(O+1)},children:"Like"})]}),Object(l.jsx)("p",{children:t.user.username}),Object(l.jsx)("div",{style:h,children:Object(l.jsx)("button",{id:"remove-button",onClick:function(){a(t.id,c.token,t)},children:"Remove"})})]}):Object(l.jsxs)("div",{style:i,className:"blog",children:[t.title," ",t.author," ",Object(l.jsx)("button",{onClick:g,children:"view"})]})},b=n(5),d=n.n(b),p="/api/blogs",O=null,f={getAll:function(){return d.a.get(p).then((function(e){return e.data}))},setToken:function(e){O="bearer ".concat(e)},create:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,d.a.post(p,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return d.a.put("".concat(p,"/").concat(e),t).then((function(e){return e.data}))},remove:function(e,t){return d.a.delete("".concat(p,"/").concat(e),{headers:{Authorization:t}}).then((function(e){return e.data}))}},h={login:function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=function(e){var t=e.message,n=e.type;return null===t?null:1===n?Object(l.jsx)("div",{className:"notification",children:t}):Object(l.jsx)("div",{className:"error",children:t})},v=function(e){var t=e.createBlog,n=Object(r.useState)(""),c=Object(s.a)(n,2),a=c[0],i=c[1],o=Object(r.useState)(""),u=Object(s.a)(o,2),j=u[0],b=u[1],d=Object(r.useState)(""),p=Object(s.a)(d,2),O=p[0],f=p[1];return Object(l.jsxs)("div",{className:"formDiv",children:[Object(l.jsx)("div",{children:Object(l.jsx)("h2",{children:"Create new"})}),Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:a,author:j,url:O}),i(""),b(""),f("")},children:[Object(l.jsxs)("p",{children:["Title:",Object(l.jsx)("input",{id:"title-input",value:a,onChange:function(e){i(e.target.value)}})]}),Object(l.jsxs)("p",{children:["Author:",Object(l.jsx)("input",{id:"author-input",value:j,onChange:function(e){b(e.target.value)}})]}),Object(l.jsxs)("p",{children:["Url:",Object(l.jsx)("input",{id:"url-input",value:O,onChange:function(e){f(e.target.value)}})]}),Object(l.jsx)("button",{id:"create-button",type:"submit",children:"Create"})]})]})},x=Object(r.forwardRef)((function(e,t){var n=Object(r.useState)(!1),c=Object(s.a)(n,2),a=c[0],i=c[1],o={display:a?"none":""},u={display:a?"":"none"},j=function(){i(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:j}})),Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{style:o,children:Object(l.jsx)("button",{onClick:j,children:e.buttonLabel})}),Object(l.jsxs)("div",{style:u,children:[e.children,Object(l.jsx)("button",{onClick:j,children:"cancel"})]})]})}));x.displayName="Togglable";var m=x,w=function(){var e=Object(r.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),i=Object(s.a)(a,2),b=i[0],d=i[1],p=Object(r.useState)(""),O=Object(s.a)(p,2),x=O[0],w=O[1],k=Object(r.useState)(null),y=Object(s.a)(k,2),S=y[0],C=y[1],B=Object(r.useState)(null),T=Object(s.a)(B,2),N=T[0],I=T[1],A=Object(r.useRef)();Object(r.useEffect)((function(){f.getAll().then((function(e){return c(e.sort((function(e,t){return parseInt(t.likes)-parseInt(e.likes)})))}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);C(t),f.setToken(t.token)}}),[]);var L=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log("loggin in"),e.prev=2,e.next=5,h.login({username:b,password:x});case 5:n=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),f.setToken(n.token),C(n),d(""),w(""),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),I("wrong username or password"),setTimeout((function(){I(null)}),5e3);case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}(),D=function(e,t){f.update(e,t)},J=function(e,t,r){window.confirm("Remove blog ".concat(r.title," by ").concat(r.author,"?"))&&f.remove(e,"bearer ".concat(t)).then((function(){c(n.filter((function(t){return t.id!==e}))),I("Blog Deleted"),setTimeout((function(){I(null)}),5e3)}))};return null===S?Object(l.jsxs)("div",{children:[Object(l.jsx)(g,{message:N,type:0}),Object(l.jsx)("h2",{children:"Log in to application"}),Object(l.jsxs)("form",{onSubmit:L,children:[Object(l.jsxs)("div",{children:["username",Object(l.jsx)("input",{id:"username",type:"text",value:b,name:"Username",onChange:function(e){var t=e.target;return d(t.value)}})]}),Object(l.jsxs)("div",{children:["password",Object(l.jsx)("input",{id:"password",type:"password",value:x,name:"Password",onChange:function(e){var t=e.target;return w(t.value)}})]}),Object(l.jsx)("button",{id:"login-button",type:"submit",children:"login"})]})]}):Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"BLOGS"}),Object(l.jsx)(g,{message:N,type:1}),Object(l.jsx)("div",{children:Object(l.jsxs)("p",{children:[S.name," logged in ",Object(l.jsx)("button",{onClick:function(){return C(null),void window.localStorage.clear()},children:"logout"})]})}),n.map((function(e){return Object(l.jsx)(j,{blog:e,updateBlog:D,user:S,removeBlog:J},e.id)})),Object(l.jsx)(m,{buttonLabel:"create new blog",ref:A,children:Object(l.jsx)(v,{createBlog:function(e){A.current.toggleVisibility(),f.create(e).then((function(t){c(n.concat(t)),I("A new blog ".concat(e.title," by ").concat(e.author," added")),setTimeout((function(){I(null)}),5e3)}))}})})]})};a.a.render(Object(l.jsx)(w,{}),document.getElementById("root"))},8:function(e,t,n){}},[[42,1,2]]]);
//# sourceMappingURL=main.e1216131.chunk.js.map